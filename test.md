---
title: 자바스크립트 엔진 런타임 비동기 작동 방식, 동작 원리 및 블로킹
date: '2024-01-09'
tags: ['study']
draft: false
summary: 자바스크립트 엔진 런타임 비동기 작동 방식, 동작 원리 및 블로킹를 공부하여 정리한 글 입니다.
---

![header](https://capsule-render.vercel.app/api?type=rect&color=auto&text=%20%20STUDY%20%20&fontAlign=30&fontSize=15&textBg=true&desc=강의%20내용을%20바탕으로%20나의%20경험,생각을%20작성&descAlign=60&descAlignY=50&animation=twinkling)

### ⚠ 참고 사항

```javascript

import { useState } from "react";

export default function blogPage() {
 const [블로그 내용, 내가 적은 내용] = useState('나의 주관적 생각 + 잘못 이해한 내용')
  return (
    <article>
      {블로그 내용}
      // 관련 된 내용을 내가 직접 공부하여 정리한 내용!!
      // 주관적 생각과 나의 이해를 바탕으로 적은 글이라 정확하지 않을 수 있음
      // 추후의 내용이 추가 되거나 수정 될 수 있음
    </article>
  );
}

```

# 목차

[1. 개요](#개요)

[2. 비동기](#비동기)

[3. 논블로킹](#논블로킹)

[4. 싱글스레드](#싱글스레드)

[5. 자바스크립트 런타임](#자바스크립트-런타임)

[6. 결론](#결론)

## 개요

<img
  src="https://velog.velcdn.com/images%2Fchoijw1116%2Fpost%2Fcec958c0-57ba-48f4-bcc7-a12f9efa1e08%2Fjavascript_runtime.png"
  width="100%"
  height="300"
/>
&uarr; [자바스크립트 런타임](https://development-mark.vercel.app/blog/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%20%EC%97%94%EC%A7%84

그전 포스팅 이후 자바스크립트 런타임에 대해 보다 자세히 다룰 예정

## 자바스크립트 런타임 (V8)

- JavaScript가 구동되는 환경

- 종류로는 웹 브라우저(크롬, 파이어폭스) 와 NodeJs라는 프로그램이 존재 함

- 비동기 처리를 하며 싱글 스레드 및 논블로킹 처리 함

## 비동기

- 비동기는 요청과 결과가 동시에 일어나지 않는다를 의미 (Asynchronous: 동시에 일어나지 않는)

- 이와 반대로 요청을 보낸 후 해당 요청의 응답을 받아야 다음 동작을 실행

```javascript
console.log('일을 분배 해야겠다')
console.log('A: 할당 받았습니다.')
console.log('B: 할당 받았습니다.')
console.log('C: 할당 받았습니다.')
console.log('D: 할당 받았습니다.')

setTimeout(() => {
  console.log('A: 완료')
}, 2000)

setTimeout(() => {
  console.log('B: 완료')
}, 1000)

setTimeout(() => {
  console.log('C: 완료')
}, 1500)

console.log('할당 완료!')
console.log('D: 완료')
```

```javascript

비동기 과정을 통한 콘솔 결과 값

일을 분배 해야겠다.
A: 할당 받았습니다.
B: 할당 받았습니다.
C: 할당 받았습니다.
D: 할당 받았습니다.
할당 완료!
D: 완료
B: 완료
C: 완료
A: 완료

```

- setTimeout 함수 자체의 실행은 즉시 실행되고 리턴

- '일을 분배 해야겠다.' 메세지가 출력 되므로 코드가 아래까지 실행 된걸 확인가능

- 실행컨텍스트를 통해 setTimeout 함수가 즉시 종료 (예약하는일이 전부)

<img src="public\static\images\비동기.png" width="100%" height="300" />

&uarr; 시간의 흐름에 따라 작업 완료 순서

- setTimeout 에 의해 기다리는 동작은 본래의 코드 흐름과는 상관 없이 따로따로 독립적으로 돌아감 (비동기 작업)

- 비동기 방식은 순서의 따른 것이 아닌 위 그림과 같이 무작위 순서로 실행

### 비동기 성능의 장점

- 요청한 작업에 대하여 완료까지 기다리지 않고 그다음 작업을 수행 함

- 즉 멀티작업을 진행 시켜 시스템 성능 향상에 도움이 됨

### 비동기 작업이 필요한 경우

- 사용자 이벤트 처리 ex) 버튼, 스크롤 등으로 발생하는 특정 이벤트

- 네트워크 응답 처리 ex) 화면에서 서버에게 요청을 보냈을 때

- 의도적으로 시간 지연을 사용하는 기능 ex) 알람, 구글 캘린더

## 논블로킹

- 현재 작업에 대한 결과를 어떻게 다룰것이냐에 따라 블로킹[^1] or 논 블로킹[^2]으로 나눔

- **특정 작업의 완료를 기다리는 동안(block) 프로그램의 제어권이 해당 지점에서 잠시 중단되는 상태를 누가 주체가 될것인지를 의미 함**

### 비동기가 논블로킹인가?

- 비동기는 어떤 작업이 완료될 때까지 기다리지 않고, 다른 작업을 수행할 수 있는 방식

- 논블로킹은 입출력 작업이 완료될 때까지 기다리지 않고, 다른 작업을 수행할 수 있는 방식

- 비동기는 네트워크 요청(API 호출), 파일 읽기/쓰기, 타이머 이벤트 등이 비동기 호출에 해당

- 논블로킹은 파일 읽기/쓰기, 네트워크 통신 등이 논블로킹 입출력에 해당

## 싱글스레드

- 싱글 스레드(single thread = 한 가닥)

  - 바늘 구멍에 실을 꿰는 것 처럼 한 가지 작업을 실행하기 위해 순차적으로 진행 시켜야 함 (실제로 코드를 실처럼 이어 놓았다고 해서 유래된 이름)

  - 싱글 스레드란 하나의 프로그램에서 동시에 하나의 코드만 실행할 수 있다는 뜻

#### 콜 스택(Call Stack)과 메모리 힙(Memory Heap)

<img src="public\static\images\자바스크립트 엔진.png" width="100%" height="300" />

- **콜 스택** : 코드 실행에 따라 호출 스택이 쌓이는 곳. 자바스크립트 엔진은 단 하나의 호출 스택을 사용

- 메모리 힙 : 자바스크립트에서 사용되는 메모리 공간

- 콜 스택은 코드를 읽고 함수가 실행되는 순서를 기억

- 자바스크립트는 싱글 스레드 프로그래밍 언어 (한 가지 일 밖에 하지 못함)

- 하나의 힙 영역과 하나의 콜 스택을 가짐

- 콜 스택은 실행 컨텍스트 과정과 매우 유사

#### 📌 자바스크립트 런타임에서 비동기 처리 방법

<img src="public\static\images\자바스크립트 런타임.png" width="100%" height="300" />

- 이벤트 루프는 이 전체 시스템에서 아주 단순한 일을 하는 작은 파트 (그러나 매우 중요)

- 이벤트 루프의 역할은 콜 스택과 콜백 큐를 주시

- 콜 스택이 비어있으면 큐의 첫 번째 콜백을 스택에 쌓아 효과적으로 실행할 수 있게 함

- 이벤트 루프는 콜 스택이 비어질 때까지 기다린 후 콜백 큐에 있는 콜백을 콜 스택에 넣어주는 역할 (싱글 스레드)

- Web API의 콜백이 완료되었다면 콜백은 큐에 쌓이게 되고, 이벤트 루프에 의해서 실행

✨이미지 처리나 애니메이션이 너무 잦거나 스택에 영향이 가는 느린 코드가 쌓이면 실행 속도의 영향이 감

[^1]: `블로킹`란 요청에 대한 결과를 바로 줄 수 없는 경우 그 결과를 기다리도록 하는것을 의미

<img src="public\static\images\블로킹.png" width="100%" height="300" />

[^2]: `블로킹`란 요청에 대한 결과를 바로 줄 수 없는 경우 그 결과를 기다리지 않음

<img src="public\static\images\논블로킹.png" width="100%" height="300" />
